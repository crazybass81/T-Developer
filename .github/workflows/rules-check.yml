name: CLAUDE.md Rules Check

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  rules-check:
    name: Check CLAUDE.md Rules
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Run rules check
        run: |
          echo "ğŸ” Checking CLAUDE.md rules compliance..."
          python3 check-rules.py || true
          echo ""
          echo "ğŸ“Š Rules check completed (non-blocking)"

      - name: Comment on PR if rules violations
        if: github.event_name == 'pull_request'
        continue-on-error: true
        run: |
          OUTPUT=$(python3 check-rules.py 2>&1) || true
          if echo "$OUTPUT" | grep -q "âŒ ê·œì¹™ ìœ„ë°˜"; then
            echo "::warning::CLAUDE.md rules violations detected. Please review and fix."
          fi
